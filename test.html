<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test de H√°bitos Olibalife</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>

* { box-sizing: border-box; margin: 0; padding: 0; }

/* ================= BODY ================= */
body {
   background: #d0d0d0;
  font-family: 'Intel', sans-serif;
  display: flex;
  min-height: 100svh;                 /* FIX MOBILE */
  
  overflow-x: hidden;                 /* FIX MOBILE */
  overflow-y: auto;   
  padding-bottom: 280px;                /* FIX MOBILE */
}

/* ================= HEADER ================= */
.floating-header {
  position: fixed;
  top: 10px;
  left: 0;
  width: 100%;
  background: transparent;
  z-index: 9999;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px 10px;
  animation: fadeDown 0.6s ease-out;
}

@keyframes fadeDown {
  from { transform: translateY(-20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
.cta {
    background: #1f2937;
  color: #ffffff;
  font-weight: 400;
  font-size: 1rem;
  padding: 14px 18px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
  text-align: center;
  text-decoration: none;
  display: inline-block;
  margin: 4px 4px;
  scale: 0.8;
}

/* Hover / Focus */
.cta:hover,
.cta:focus {
  transform: translateY(-2px) scale(1.05);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
  background: linear-gradient(135deg, #00ff77, #ffffff);
  outline: none;
  color: black;
}

/* Active / Click */
.cta:active {
  transform: translateY(0px) scale(0.98);
  box-shadow: 0 5px 12px rgba(0, 0, 0, 0.2);
}
.dock-menu {
  display: flex;
  gap: 18px;
 background: #dbe0e7;
  padding: 18px 20px;
  border-radius: 22px;
  backdrop-filter: blur(15px);
  box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
}

.dock-item {
  font-size: 1.1rem;
  color: #1f2937;
  text-decoration: none;
  transition: transform 0.25s ease, filter 0.25s ease, color 0.25s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dock-item:hover {
  transform: scale(1.35);
  color: #0f9b4d;
  filter: drop-shadow(0 5px 8px rgba(0, 0, 0, 0.25));
}

/* ================= SIDEBAR / MAIN ================= */
.sidebar {
  width: 100%;
  backdrop-filter: blur(12px);
  display: flex;
  flex-direction: column;
  border-right: 1px solid rgba(255,255,255,0.2);
  height: 100%;
}

.main {
   color: #ffffff;
  width: 100%;
  margin-top: 35px;
  height: 800px;
  flex: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow: hidden;
  border-radius: 18px ;
 background: #1f293700;
  

}

/* ================= INFO ================= */
.info {
  margin: 34px;
  width: 100%;
  max-width: 480px;                  /* FIX MOBILE */
  height: 800px;
  min-width: 380;
  flex: 1;
  backdrop-filter: blur(12px);
 background: linear-gradient(195deg, #ffffff, #80b49ae9);
  padding: 20px;
  border-right: 1px solid rgba(0, 0, 0, 0.841);
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  overflow-y: auto;
  overflow-x: hidden;
  z-index: 9000;
  border-radius: 20px;
}

/* ================= RESULTS (LEGACY) ================= */
.results {
  margin: 0px;
  width: 40%;
  flex: 1;
  backdrop-filter: blur(12px);
  background: rgba(255, 0, 0, 0.804);
  padding: 40px;
  border-left: 1px solid rgba(255,255,255,0.2);
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  overflow-y: auto;
  overflow-x: hidden;
  border-radius: 20px;
}

/* ================= FORM ================= */
.form-card {
  backdrop-filter: blur(20px);
 background:  #dbe0e7;
  padding: 55px;
  border-radius: 20px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.1);
  width: 100%;
  max-width: 300px;
  margin-bottom: 0px;
  color: black;
}

h2 {
  text-align: center;
  margin: 18px;
  color: rgb(0, 0, 0);
}

h3 {
  text-align: center;
  margin: 20px;
  color:  #ffffff;
}

/* ================= AVATAR ================= */
.avatar-img {
  width: 40px;
  height: auto;
  border-radius: 0px;
  display: block;
  position: fixed;
  bottom: 100px;
  right: 50px;
  z-index: 99999;
}

/* ================= QUIZ ================= */
.quiz-form {
  display: flex;
  flex-direction: column;
  gap: 12px;                         /* FIX MOBILE */
  width: 100%;
  max-width: 100%;                   /* FIX MOBILE */
  color:#1f2937;
  font-size: clamp(14px, 3.5vw, 16px); /* FIX MOBILE */
}

#quizProgress {
  height: 0px;
  width: 100%;
background: linear-gradient(135deg, #d8d8d8, #ffffff);
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 0px;
}

.question-card {
  width: 100%;
  backdrop-filter: blur(20px);
  background: #dbe0e762;
  border-radius: 16px;
  padding: 14px 16px;               /* FIX MOBILE */
  box-shadow: 0 6px 20px rgba(255, 255, 255, 0.786);
}

.question-title {
  font-weight: 600;
  font-size: 1rem;
  margin-bottom: 8px;
  color: #0c2400;
}

.options {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

/* ================= PROGRESS ================= */
.progress-circle {
  width: 60px;
 left: 10px;
  height: 60px;
  flex-shrink: 0;
  border-radius: 50%;
  background: conic-gradient(#49f360 0deg, #ddd 0deg);
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 20px;
  box-shadow: 0 0 15px rgba(32, 192, 82, 0.901);
  transition: background 1s ease-out;
}

.progress-circle span {
  font-weight: 600;
  font-size: 1.1rem;
  color: #000;
}

.category-cards-container {
  bottom: 0;                 /* Pegado al borde inferior */
  left: 50%;                 /* Centrado horizontal */
  margin: 40px;
  width: 99%;                /* Margen lateral peque√±o */
  max-width: 380px;                  /* FIX MOBILE */
  height: 800px;             /* Altura del contenedor */
 background: #1f2937;
  backdrop-filter: blur(15px);        /* Efecto de desenfoque */
  border-radius: 20px;      /* Solo esquinas superiores redondeadas */
  padding: 10px;
  gap: 15px;                 /* Espacio entre cards */
  overflow-x: hidden;          /* Scroll horizontal si hay muchas cards */
  z-index: 8500;             /* Encima del canvas pero debajo del modal */
  box-shadow: 0 -4px 12px rgba(0,0,0,0.15);
  flex: 3;
}

/* Individual cards dentro del contenedor */
.category-card {
  flex: 0 0 auto;            /* No se comprima */
  width: auto;
  background: rgba(245, 245, 245, 0.043);
  color: #ffffff;
  border-radius: 20px;
  padding: 28px;
  display: flex;
  flex-direction: column;
  gap: 30px;
  box-shadow: 0 4px 12px rgba(54, 192, 223, 0.968);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  margin: 10px;

}


.category-bar {
  width: 100%;
  height: 6px;
  border-radius: 10px;
  background: rgba(67, 67, 67, 0.2);
  overflow: hidden;
}

.category-bar-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #ff0000, #00ff33);
  border-radius: 10px;
  transition: width 1s ease-out;
}

/* ================= THREE ================= */
#threeCanvas-container {
  position: absolute;
  top: 48%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  height: 73%;
  display: flex;
  padding: 10px;
  justify-content: center;
  align-items: center;
}

#threeCanvas {
  max-width: 99%;
  height: 580px;
  border-radius: 8px;
background: rgba(255, 255, 255, 0.947);

}




.results2 {
  position: fixed;       /* Fijamos en la ventana */
  bottom: 0;             /* Pegado al borde inferior */
  left: 0;               /* Desde la izquierda */
  width: 100%;           /* Lado a lado */
  max-width: 100%;
  height: 250px;         /* Altura del contenedor */
  padding: 20px 60px;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  overflow-y: auto;      /* Scroll interno si hay mucho contenido */
  overflow-x: hidden;
  background: #dbe0e7;
  color: #000000;
  z-index: 9000;         /* Encima de canvas y dem√°s */
}
/* ================= HEALTH HUD ================= */
.health-hud-container {
  width: 100%;               /* Margen lateral peque√±o */
  max-width: 100%;
  max-height: 200px;
  padding: 10px 20px;
 background: #1f2937;
  backdrop-filter: blur(12px);
  border-radius: 20px;
  text-align: center;
  z-index: 9500;            /* Encima de canvas pero debajo del modal */
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.944);
  font-weight: 400;
  font-size: 1rem;
  color: #ffffff;
}



/* ================= MINI MODAL FULLSCREEN CENTRADO ================= */
.mini-modal {
  position: fixed;
  inset: 0; /* Ocupa toda la pantalla */
  background: rgb(255, 255, 255); /* Fondo semi-transparente */
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 999999;
  padding: 20px; /* Espacio alrededor del modal */
}

/* Contenido del modal */
.mini-modal-content {
  position: relative;
  background: #fff;
  border-radius: 18px; /* Esquinas suaves */
  width: 90%;          /* Margen lateral del 5% a cada lado */
  max-width: 900px;    /* Ancho m√°ximo para desktop */
  height: 90%;         /* Altura m√°xima del 90% de la ventana */
  display: flex;
  flex-direction: column;
  padding: 20px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
  overflow: hidden; /* Evita scroll interno */
}

/* Iframe dentro del modal */
.mini-login-iframe {
  width: 100%;
  height: 100%; /* Ocupa todo el alto del modal */
  border: none;
  border-radius: 12px;
}

/* Bot√≥n cerrar */
.mini-modal-close {
  position: absolute;
  top: 15px;
  right: 15px;
  background: rgba(255,255,255,0.9);
  border: none;
  font-size: 1.6rem;
  cursor: pointer;
  padding: 4px 10px;
  border-radius: 6px;
  z-index: 10;
}


/* ---------- TABLET / SMALL DESKTOP ---------- */
@media (max-width: 900px) {
  body,
  .main {
    padding-bottom: 230px;
  }

  .results {
    display: none;
  }

  .info {
    max-width: 90%;
  }

  #threeCanvas-container,
  #threeCanvas {
    height: 400px;
  }

  .results2 {
    height: 220px;
    padding: 15px 20px;
  }
}




/* ================= TABLET 748 ================= */
@media (max-width: 748px) {

  /* ===== BODY ===== */
  body {
    flex-direction: column;
    padding-bottom: 220px; /* espacio para results2 fijo */
  }

  /* ===== HEADER ===== */
  .floating-header {
    top: 8px;
    padding: 10px;
  }

  .dock-menu {
    gap: 14px;
    padding: 14px 18px;
    border-radius: 20px;
  }

  .dock-item {
    font-size: 1.1rem;
  }

  /* ===== MAIN ===== */
  .main {
    margin-top: 70px;
    height: auto;
    overflow: visible;
    border-radius: 16px;
  }

  /* ===== INFO (QUIZ) ===== */
  .info {
    margin: 30px auto;
    width: 90%;
    max-width: 520px;
    max-height: none;
    overflow: visible;
    padding: 18px;
    border-radius: 20px;
  }

  .quiz-form {
    font-size: 1rem;
    gap: 12px;
  }

  /* ===== THREE + RESULTS LAYOUT ===== */
  #threeCanvas-container {
    position: relative;
    top: auto;
    left: auto;
    transform: none;
    margin: 30px auto;
    height: auto;
  }

  #threeCanvas {
    height: 340px;
    max-width: 95%;
    border-radius: 24px;
  }

  /* ===== CATEGORY RESULTS ===== */
  .category-cards-container {
    position: relative;
    margin: 30px auto;
    width: 90%;
    max-width: 520px;
    height: auto;
    padding: 18px;
    overflow: visible;
  }

  .category-card {
    width: 100%;
    margin-bottom: 16px;
    padding: 26px;
  }

  /* ===== RESULTS2 (FIXED) ===== */
  .results2 {
    height: 190px;
    padding: 16px 22px;
    font-size: 0.9rem;
  }

  /* ===== HEALTH HUD ===== */
  .health-hud-container {
    font-size: 1rem;
    padding: 10px 16px;
    border-radius: 18px;
  }

  /* ===== AVATAR ===== */
  .avatar-img {
    width: 10px;
    bottom: 14px;
    right: 14px;
  }

  /* ===== LEGACY RESULTS ===== */
  .results {
    display: none;
  }

  /* ===== MINI MODAL ===== */
  .mini-modal-content {
    width: 92%;
    height: 92%;
    padding: 16px;
    border-radius: 16px;
  }
}




/* ================= MOBILE 600 ================= */
@media (max-width: 600px) {

  /* ===== BODY ===== */
  body {
    flex-direction: column;
    padding-bottom: 190px; /* deja espacio para results2 */
    overflow-y: auto;
  }

  /* ===== HEADER ===== */
  .floating-header {
    top: 6px;
    padding: 8px;
  }

  .dock-menu {
    gap: 12px;
    padding: 12px 14px;
    border-radius: 18px;
  }

  .dock-item {
    font-size: 1rem;
  }

    .cta {
    width: 100%;         /* ocupa todo el ancho en m√≥viles */
    font-size: 0.95rem;
    padding: 12px 20px;
    margin: 6px 0;
  }
  /* ===== MAIN STRUCTURE ===== */
  .main {
    margin-top: 90px; /* deja respirar al header */
    height: auto;
    border-radius: 0;
    overflow: visible;
    padding-bottom: 10px;
  }

  /* ===== INFO (QUIZ) ‚Äî PRIORIDAD ===== */
  .info {
    margin: 20px auto;
    width: 92%;
    max-width: 100%;
    max-height: none;
    overflow: visible;
    padding: 14px;
    border-radius: 18px;
  }

  .quiz-form {
    font-size: 0.95rem;
    gap: 10px;
  }

  .question-card {
    padding: 14px;
  }

  /* ===== PROGRESS ===== */
  .progress-circle {
    width: 80px;
    height: 80px;
  }

  /* ===== THREE CANVAS ===== */
  #threeCanvas-container {
    position: relative;
    top: 40px;
    left: auto;
    transform: none;
    height: auto;
    margin: 10px 10px;
  }

  #threeCanvas {
    height: 400px;
    max-width: 100%;
    border-radius: 20px;
    margin: 0px 10px;
  }


  /* ===== CATEGORY RESULTS ===== */
  .category-cards-container {
     top: auto;
    left: auto;
    margin: 10px;
    width: 100%;
    max-width: 95%;
    height: 800px;
    padding: 8px;
    overflow: visible;
  }

  .category-card {
    width: 100%;
    margin: 0 0 4px 0;
    padding: 20px;
  }

  /* ===== RESULTS2 ‚Äî FIXED PERO LIGERO ===== */
  .results2 {
    height: 175px;
    padding: 28px 60px;
    font-size: 0.85rem;
    backdrop-filter: blur(18px);
  }

  /* ===== HEALTH HUD ===== */
  .health-hud-container {
    font-size: 0.95rem;
    padding: 8px 12px;
    border-radius: 16px;
  }

  /* ===== AVATAR ===== */
  .avatar-img {
    width: 60px;
    bottom: 99px;
    right: 50px;
  }

  /* ===== LEGACY RESULTS (OFF) ===== */
  .results {
    display: none;
  }

  /* ===== MINI MODAL ===== */
  .mini-modal-content {
    width: 95%;
    height: 95%;
    padding: 12px;
    border-radius: 14px;
    z-index: 99999;
  }

  .mini-login-iframe {
    min-height: 0;
     z-index: 99999;
  }
    .cta {
    width: 100%;
    font-size: 0.95rem;
    padding: 12px 20px;
  }  
  
  .mini-modal-close {
  position: absolute;
  top: 15px;
  right: 15px;
  background: rgba(255,255,255,0.9);
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
  padding: 4px 10px;
  border-radius: 6px;
  z-index: 9999999;
}

    #resultsHUD {
    position: relative;       /* ya no absoluto, para adaptarse al flujo */
    top: 0px;                /* eliminar desplazamiento desde arriba */
    left: auto;
    transform: none;          /* no necesitamos translateX */
    width: 90%;               /* ocupa casi todo el ancho */
    max-width: 5%;           /* l√≠mite m√°ximo */
    height: auto;             /* se ajusta al contenido */
    max-height: none;         /* sin l√≠mite de altura */
    padding: 2px;            /* reduce padding para m√≥vil */
    border-radius: 16px;      /* un poquito m√°s compacto */
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    pointer-events: none;
    scale: 1;
    background-image: url('https://test.olibalife.site/bannercambiar.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-blend-mode: overlay;
    background-color: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(40px); /* menos blur para mejor performance en m√≥vil */
  }
}
/* ================= MOBILE SMALL 458 CORREGIDO ================= */
@media (max-width: 480px) {

  /* ===== BODY ===== */
  body {
    flex-direction: column;
    padding-bottom: 190px; /* espacio para results2 */
    overflow-y: auto;
  }

  /* ===== HEADER ===== */
  .floating-header {
    top: 6px;
    padding: 8px;
  }

  .dock-menu {
    gap: 12px;
    padding: 12px 14px;
    border-radius: 18px;
  }

  .dock-item {
    font-size: 1rem;
  }

  /* ===== MAIN STRUCTURE ===== */
  .main {
    margin-top: 20px; /* deja respirar al header */
    height: auto;
    border-radius: 0;
    overflow: visible;
    padding-bottom: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* ===== INFO (QUIZ) ‚Äî PRIORIDAD ===== */
  .info {
   
    margin: 20px auto;
    width: 92%;
    max-width: 100%;
    max-height: none;
    overflow: visible;
    padding: 14px;
    border-radius: 18px;
  }

  .quiz-form {
    font-size: 0.95rem;
    gap: 10px;
  }

  .question-card {
    padding: 14px;
  }

  /* ===== PROGRESS ===== */
  .progress-circle {
    width: 80px;
    height: 80px;
  }

  /* ===== THREE CANVAS ===== */
  #threeCanvas-container {
 
    position: relative;
    top: 20px;
    left: auto;
    transform: none;
    height: auto;
    margin: 20px 0;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 95%;
  }

  #threeCanvas {
    height: 260px;
    max-width: 100%;
    border-radius: 20px;
  }

  /* ===== CATEGORY RESULTS (CENTRADO Y ESCALADO) ===== */
  .category-cards-container {
    position: relative;
    margin: 16px auto; /* centrado horizontal */
    width: 95%;
    max-width: 100%;
    height: auto;
    padding: 14px;
    overflow: visible;
  }

  .category-card {
    width: 100%;
    margin: 0 0 12px 0; /* sin margen lateral */
    padding: 22px;
  }

  /* ===== RESULTS2 ‚Äî FIXED ESCALADO ===== */
  .results2 {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    max-width: 100%;
    height: 140px;
    padding: 12px 16px;
    font-size: 0.85rem;
    backdrop-filter: blur(8px);
    overflow-y: auto;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    z-index: 9000;
  }

  /* ===== HEALTH HUD ===== */
  .health-hud-container {
    font-size: 0.95rem;
    padding: 8px 12px;
    border-radius: 16px;
    width: 95%;
    margin: 8px auto;
  }

  /* ===== AVATAR ===== */
  .avatar-img {
    width: 110px;
    bottom: 12px;
    right: 12px;
  }

  /* ===== LEGACY RESULTS (OFF) ===== */
  .results {
    display: none;
  }

  /* ===== MINI MODAL ===== */
  .mini-modal-content {
    width: 95%;
    height: 95%;
    padding: 12px;
    border-radius: 14px;
  }

  .mini-login-iframe {
    min-height: 0;
  }

  /* ===== CTA BUTTON ===== */
  .cta {
    width: 100%;
    font-size: 0.95rem;
    padding: 12px 20px;
  }
}



</style>
</head>
<body>

<header class="floating-header">
  
</header>


<div class="info"><nav class="dock-menu">
  
    <a href="https://test.olibalife.site/" class="dock-item"> <i class="fa-solid fa-dna"></i> </a>
    <a href="https://test.olibalife.site/login.html" class="dock-item"><i class="fa-solid fa-user"></i></a>
  </nav>
 
  <h2>Test de h√°bitos saludables</h2>

  <form id="quizForm" class="quiz-form">
    

    <div class="question-card">
      <div class="question-title">1. Nivel de energ√≠a diario</div>
      <div class="options">
        <label class="option"><input type="radio" name="q1" value="20"> Alta</label>
        <label class="option"><input type="radio" name="q1" value="15"> Moderada</label>
        <label class="option"><input type="radio" name="q1" value="10"> Baja</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">2. Horas de sue√±o promedio</div>
      <div class="options">
        <label class="option"><input type="radio" name="q2" value="20"> 7-8 h</label>
        <label class="option"><input type="radio" name="q2" value="15"> 5-6 h</label>
        <label class="option"><input type="radio" name="q2" value="10"> Menos de 5 h</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">3. Frecuencia de ejercicio</div>
      <div class="options">
        <label class="option"><input type="radio" name="q3" value="20"> Diario</label>
        <label class="option"><input type="radio" name="q3" value="15"> 2-3 veces/semana</label>
        <label class="option"><input type="radio" name="q3" value="10"> Rara vez</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">4. Consumo de frutas y verduras</div>
      <div class="options">
        <label class="option"><input type="radio" name="q4" value="20"> Diario</label>
        <label class="option"><input type="radio" name="q4" value="15"> 3-4 veces/semana</label>
        <label class="option"><input type="radio" name="q4" value="10"> Menos de 3 veces/semana</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">5. Hidrataci√≥n diaria</div>
      <div class="options">
        <label class="option"><input type="radio" name="q5" value="20"> 2 litros o m√°s</label>
        <label class="option"><input type="radio" name="q5" value="15"> 1-2 litros</label>
        <label class="option"><input type="radio" name="q5" value="10"> Menos de 1 litro</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">6. Nivel de estr√©s</div>
      <div class="options">
        <label class="option"><input type="radio" name="q6" value="10"> Bajo</label>
        <label class="option"><input type="radio" name="q6" value="15"> Moderado</label>
        <label class="option"><input type="radio" name="q6" value="20"> Alto</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">7. Tiempo frente a pantallas</div>
      <div class="options">
        <label class="option"><input type="radio" name="q7" value="20"> Menos de 2 h</label>
        <label class="option"><input type="radio" name="q7" value="15"> 2-5 h</label>
        <label class="option"><input type="radio" name="q7" value="10"> M√°s de 5 h</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">8. Consumo de az√∫car</div>
      <div class="options">
        <label class="option"><input type="radio" name="q8" value="20"> Bajo</label>
        <label class="option"><input type="radio" name="q8" value="15"> Moderado</label>
        <label class="option"><input type="radio" name="q8" value="10"> Alto</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">9. Consumo de alcohol</div>
      <div class="options">
        <label class="option"><input type="radio" name="q9" value="20"> Ninguno</label>
        <label class="option"><input type="radio" name="q9" value="15"> Ocasional</label>
        <label class="option"><input type="radio" name="q9" value="10"> Frecuente</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">10. Calidad de relaciones sociales</div>
      <div class="options">
        <label class="option"><input type="radio" name="q10" value="20"> Muy buena</label>
        <label class="option"><input type="radio" name="q10" value="15"> Regular</label>
        <label class="option"><input type="radio" name="q10" value="10"> Mala</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">11. Nivel de atenci√≥n y concentraci√≥n</div>
      <div class="options">
        <label class="option"><input type="radio" name="q11" value="20"> Alta</label>
        <label class="option"><input type="radio" name="q11" value="15"> Moderada</label>
        <label class="option"><input type="radio" name="q11" value="10"> Baja</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">12. Estado de √°nimo general</div>
      <div class="options">
        <label class="option"><input type="radio" name="q12" value="20"> Muy bueno</label>
        <label class="option"><input type="radio" name="q12" value="15"> Regular</label>
        <label class="option"><input class="option" type="radio" name="q12" value="10"> Bajo</label>
      </div>
    </div>

    <button type="button" class="cta" onclick="updateScore()">Ver Resultado</button>
    <button type="button" class="cta" onclick="downloadPatientFile()">Descargar mi ficha</button>
  </form>
  
</div>

<div class="main">

  <div id="hudContainer" style="position: relative; width: 99%; height: 600px; margin: 0px; z-index: 9900; ">  

    <div id="resultsHUD" style="
      position: absolute;
      padding: 10px;
      margin: 0px;
      top: 90px;
      left: 50%;
      transform: translateX(-50%);
      width: 95%;
      height: 100%;
      max-width: 480px;
      max-height: 580px;
      border-radius: 20px;
      display: flex;
   flex: 2;
      align-items: center;
      gap: 0px;
      pointer-events: none;
      scale:1;
      background-image: url('https://test.olibalife.site/bannertestfonfo.png'); /* tu imagen */
      background-size: cover;      /* cubre todo el contenedor */
      background-position: center; /* centrada */
      background-repeat: no-repeat;
      background-blend-mode: overlay;   /* mezcla con el color */
      background-color: rgba(203, 203, 203, 0);
      backdrop-filter: blur(0px);
     
      
    ">  

 <img 
  class= "avatar-img"
    src="https://test.olibalife.site/logoolibalife.png" 
    alt="Estudio epigen√©tico" >
      
 <div id="threeCanvas-container">
  <canvas id="threeCanvas"></canvas>
</div>      
   </div>      
      </div>     
          </div>
    

<div class="category-cards-container"> 
    <h3>Tus resultados</h3>  
      

       <div class="progress-circle" id="progressCircleHUD">
   <span>0%</span>
   </div> 
     <div class="health-hud-container">

  <div id="healthMessageHUD"></div>
  

</div>
  <div class="category-cards" id="categoriesContainerHUD"></div>
</div>


  <!-- Mini Modal -->
  <div id="miniLoginModal" class="mini-modal">
    <div class="mini-modal-content">
      <button class="mini-modal-close" id="closeMiniLogin">‚úï</button>
      <iframe 
        src="https://test.olibalife.site/login.html" 
        class="mini-login-iframe" 
        frameborder="0" 
        loading="lazy">
      </iframe>
    </div>
  </div>
<div class="results2">



   <h2>¬øSientes que necesitas un estudio avanzado?</h2>

  <!-- Bot√≥n para abrir mini-login -->
  <button id="openMiniLogin" class="cta">Reg√≠strate gratis.</button>


  <p>
   Con una simple muestra capilar analizamos c√≥mo est√°n funcionando tus c√©lulas y qu√© factores pueden estar afectando a tu energ√≠a, tu metabolismo y tu bienestar.

  </p>
  <p>
    <strong>¬øQu√© analiza?</strong> Carencias de vitaminas, minerales y antioxidantes
Estr√©s celular, inflamaci√≥n y envejecimiento interno
Sensibilidades alimentarias
Estado de tu microbiota y digesti√≥n
T√≥xinas ambientales: metales pesados, qu√≠micos y radiaciones
Interferencias EMF/ELF: wifi, m√≥viles y aparatos electr√≥nicos
C√≥mo esto implica en tu energ√≠a, metabolismo, descanso y hormonas

    <strong>Muestra:</strong> Cabello (estudio no invasivo)
    <strong>Tiempo de resultados:</strong> M√°ximo 7 d√≠as
    <strong>¬øPara qu√© sirve?:</strong> Para recibir un informe personalizado y saber qu√© h√°bitos, nutrientes o cambios necesitas aplicar para mejorar tu salud desde el origen.
  </p>

<div class="subscribe-box">
  <label><strong>Reg√≠strate y obt√©n una gu√≠a de men√∫ drenante gratis.</strong></label>

</div>
</div>


<script src="https://cdn.jsdelivr.net/npm/three@0.134.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/exporters/GLTFExporter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-W9G2DWC51B"></script>


<script>

window.dataLayer = window.dataLayer || [];
function gtag(){ dataLayer.push(arguments); }

gtag('js', new Date());

const GA_DEFAULT = 'G-W9G2DWC51B';
if (GA_DEFAULT) {
  gtag('config', GA_DEFAULT, {
    anonymize_ip: true
  });
}

const sessionId =
  sessionStorage.getItem('vhSessionId') || crypto.randomUUID();
sessionStorage.setItem('vhSessionId', sessionId);


window.trackEvent = function(eventName, payload = {}) {
  if (!eventName) return;

  const eventData = {
    session_id: sessionId,
    timestamp: Date.now(),
    ...payload
  };

  console.log('[TRACK]', eventName, eventData);

  if (typeof gtag === 'function') {
    gtag('event', eventName, eventData);
  }
};


let baseModelURL = 'https://viewer.3dtwins.tech/adnOlivalife.glb';
let gltfScene = null;
let renderer, scene, camera;

let latestScore = 0;
let latestCategories = [];
let latestTips = {}; 

function initThree() {
  const canvas = document.getElementById('threeCanvas');
  const container = document.getElementById('threeCanvas-container');

  scene = new THREE.Scene();

  // C√°mara
  camera = new THREE.PerspectiveCamera(65, container.clientWidth / container.clientHeight, 0.01, 1000);
  camera.position.set(0, 0, 5.4);

  // Renderer
  renderer = new THREE.WebGLRenderer({ alpha: true, canvas: canvas, antialias: true });
  renderer.setPixelRatio(window.devicePixelRatio); // para pantallas retina
  renderer.setSize(container.clientWidth, container.clientHeight);

  // Luces
  const light = new THREE.DirectionalLight(0xffffff, 1.2);
  light.position.set(1, 6, 5);
  scene.add(light);
  scene.add(new THREE.AmbientLight(0xffffff, 0.6));

  // Resize din√°mico
  window.addEventListener('resize', () => {
    const width = container.clientWidth;
    const height = container.clientHeight;

    renderer.setSize(width, height);
    camera.aspect = width / height;
    camera.updateProjectionMatrix();
  });
}

async function loadBaseModel() {
  return new Promise((resolve, reject) => {
    const loader = new THREE.GLTFLoader();
    loader.load(
      baseModelURL,
      (gltf) => {
        gltfScene = gltf.scene;
        gltfScene.scale.set(7.5, 6, 7.3);
        gltfScene.position.set(0, -3, -2);
        scene.add(gltfScene);
        animate();    
        trackEvent('model_loaded', { model_url: baseModelURL });
        resolve(gltfScene);
      },
      undefined,
      (err) => {
        trackEvent('model_load_error', { model_url: baseModelURL, error: err.message || err });
        reject(err);
      }
    );
  });
}


function animate() {
  requestAnimationFrame(animate);
  if(gltfScene) gltfScene.rotation.y += 0.001; 
  renderer.render(scene, camera);
}

function getTips(category, score) {
  const tipsDB = {
    'Nutrici√≥n': [
      ["Aumenta frutas y verduras diarias.", "Bebe al menos 2 litros de agua.", "Reduce az√∫cares refinados."],
      ["Incluye prote√≠nas magras en cada comida.", "Var√≠a tu dieta semanalmente.", "Controla el tama√±o de las porciones."],
      ["Mant√©n un registro de tu alimentaci√≥n.", "Experimenta con superalimentos.", "Optimiza tus horarios de comida."]
    ],
    'Ejercicio': [
      ["Camina 30 min diarios.", "Evita periodos prolongados sentado.", "Prueba ejercicios de fuerza simples."],
      ["A√±ade 2‚Äì3 sesiones de cardio por semana.", "Incorpora entrenamiento de fuerza.", "Incluye estiramientos al final de cada sesi√≥n."],
      ["Var√≠a tus rutinas semanalmente.", "Prueba entrenamientos de alta intensidad.", "Mide tus progresos con apps o dispositivos."]
    ],
    'Sue√±o': [
      ["Intenta dormir 7‚Äì8 horas.", "Evita pantallas 1h antes de dormir.", "Mant√©n horarios regulares."],
      ["Crea una rutina de relajaci√≥n nocturna.", "Controla la temperatura de tu habitaci√≥n.", "Evita cafe√≠na por la tarde."],
      ["Usa t√©cnicas de respiraci√≥n profunda.", "Eval√∫a tu colch√≥n y almohadas.", "Mant√©n un diario de sue√±o para mejorar h√°bitos."]
    ],
    'Estr√©s': [
      ["Respira profundamente varias veces al d√≠a.", "Toma peque√±os descansos durante el trabajo.", "Haz algo que disfrutes cada d√≠a."],
      ["Practica meditaci√≥n o mindfulness.", "Realiza actividad f√≠sica regular.", "Establece l√≠mites claros entre trabajo y vida personal."],
      ["Realiza ejercicios de visualizaci√≥n positiva.", "Aprende t√©cnicas de manejo del tiempo.", "Busca apoyo social o profesional cuando lo necesites."]
    ]
  };

  if(score < 40) return tipsDB[category][0];
  else if(score < 70) return tipsDB[category][1];
  else return tipsDB[category][2];
}

function updateScore() {
  const form = document.getElementById('quizForm');
  const formData = new FormData(form);
  let totalScore = 0;
  let answered = 0;

  const categories = [
    { name: 'Nutrici√≥n', questions: ['q4', 'q5'], score: 0, max: 20*2 },
    { name: 'Ejercicio', questions: ['q3'], score: 0, max: 20 },
    { name: 'Sue√±o', questions: ['q2', 'q1'], score: 0, max: 20*2 },
    { name: 'Estr√©s', questions: ['q6', 'q7', 'q8', 'q9', 'q10', 'q11', 'q12'], score: 0, max: 20*7 }
  ];

  formData.forEach((value, key) => {
    const val = parseInt(value);
    totalScore += val;
    answered++;

    categories.forEach(cat => {
      if (cat.questions.includes(key)) cat.score += val;
    });
  });

  if (answered === 0) return alert("Por favor, responde al menos una pregunta.");

  latestScore = totalScore;
  latestCategories = categories.map(cat => ({ name: cat.name, score: Math.round(cat.score / cat.max * 100) }));

  const minScore = 120;
  const maxScore = 240;
  const percent = Math.max(10, Math.round(((totalScore - minScore) / (maxScore - minScore)) * 100));

  const progressCircle = document.getElementById('progressCircleHUD');
  const angle = percent * 3.6;
  progressCircle.style.background = `conic-gradient(#00d37b 0deg, #00d37g ${angle}deg, #ddd ${angle}deg)`;
  progressCircle.querySelector('span').innerText = percent + '%';

  let message = "";
  if (percent < 40) message = "‚ö†Ô∏è Tus h√°bitos de salud necesitan mejorar. Te recomendamos tomar acci√≥n ¬°YA!.";
  else if (percent < 70) message = "üü† Est√°s en un punto intermedio, puedes mejorar algunos h√°bitos. ";
  else message = "üü¢ Excelente, tus h√°bitos son muy saludables.";
  document.getElementById('healthMessageHUD').textContent = message;

  latestTips = {};
  const container = document.getElementById('categoriesContainerHUD');
  container.innerHTML = '';

  latestCategories.forEach(cat => {
    const tips = getTips(cat.name, cat.score);
    latestTips[cat.name] = tips;

    const card = document.createElement('div');
    card.className = 'category-card show';
    card.innerHTML = `<div class="category-name">${cat.name}</div>
                      <div class="category-bar"><div class="category-bar-fill" style="width:${cat.score}%"></div></div>
                      <ul class="category-tips">
                        ${tips.map(t => `<li>${t}</li>`).join('')}
                      </ul>`;
    container.appendChild(card);
  });

  if (gltfScene) {
    gltfScene.traverse(child => {
      if (child.isMesh) {
        let color;
        if (percent < 40) color = new THREE.Color(0x000000);
        else if (percent < 70) color = new THREE.Color(0xFF6105);
        else color = new THREE.Color(0x00F004);
        child.material.color = color;
        child.material.needsUpdate = true;
      }
    });

    gltfScene.userData = { totalScore, categories: latestCategories, percent, tips: latestTips };
  }

  // ===============================
  // TRACKING: Quiz enviado / puntuaci√≥n calculada
  // ===============================
  trackEvent('quiz_submitted', {
    totalScore: latestScore,
    categories: latestCategories.map(cat => ({ name: cat.name, score: cat.score })),
    percent: percent
  });
}


async function downloadGLB() {
  if (!gltfScene) await loadBaseModel();
  const exporter = new THREE.GLTFExporter();
  exporter.parse(gltfScene, (result) => {
    const blob = result instanceof ArrayBuffer 
      ? new Blob([result], {type:'application/octet-stream'}) 
      : new Blob([JSON.stringify(result, null, 2)], {type:'application/json'});
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'resultado_habitos.glb';
    link.click();
  }, { binary: true });
}

function downloadPDF() {
  trackEvent('download_pdf_clicked', { totalScore: latestScore });

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({
    orientation: "portrait",
    unit: "pt",
    format: "a4"
  });

  const margin = 40;
  let y = 100; // margen inicial para no chocar con banner

  // ===== CABECERA SUPERIOR =====
  doc.setFillColor(0, 100, 0);
  doc.rect(0, 0, 595, 80, 'F');
  doc.setFontSize(22);
  doc.setTextColor(255, 255, 255);
  doc.setFont("helvetica", "bold");
  doc.text("Resultados Test de H√°bitos Olibalife", 297.5, 50, { align: "center" });

  // ===== Puntuaci√≥n total =====
  doc.setFontSize(14);
  doc.setFont("helvetica", "normal");
  doc.setTextColor(0, 0, 0);
  doc.text(`Puntuaci√≥n total: ${latestScore}`, margin, y);
  y += 30;

  // ===== Categor√≠as =====
  latestCategories.forEach(cat => {
    doc.setFillColor(200, 230, 201);
    doc.roundedRect(margin - 4, y - 14, 515, 24, 6, 6, 'F');

    doc.setFontSize(13);
    doc.setFont("helvetica", "bold");
    doc.setTextColor(0, 70, 0);
    doc.text(`${cat.name}: ${cat.score}%`, margin, y);

    y += 28;

    const tips = latestTips[cat.name] || [];
    doc.setFontSize(11);
    doc.setFont("helvetica", "normal");
    doc.setTextColor(50, 50, 50);

    tips.forEach(tip => {
      doc.text(`‚Ä¢ ${tip}`, margin + 10, y);
      y += 16;

      if (y > 700) { // salto de p√°gina si se pasa
        doc.addPage();
        y = 60;
      }
    });

    y += 10;
    doc.setDrawColor(200, 200, 200);
    doc.setLineWidth(0.5);
    doc.line(margin, y, 555, y);
    y += 15;
  });

  // ===== CABECERA INFERIOR AJUSTADA =====
  const footerText = 
    "www.olibalife.com | Todos los derechos reservados | Registrate gratis y obt√©n tu gu√≠a";

  doc.setFontSize(11);
  doc.setFont("helvetica", "bold");
  doc.setTextColor(0, 100, 0);

  // Ajustar texto al ancho
  const footerLines = doc.splitTextToSize(footerText, 515);
  let footerY = 780 - (footerLines.length - 1) * 14; // evitar que se pase del borde
  footerLines.forEach(line => {
    doc.text(line, 297.5, footerY, { align: "center" });
    footerY += 14;
  });

  // Guardar PDF
  doc.save('resultado_habitos.pdf');
}



function downloadPatientFile() {
  trackEvent('download_patient_file_clicked', { totalScore: latestScore });
  //downloadGLB();
  downloadPDF();
}

  const menuPdfUrl = '';

  const downloadBtn = document.getElementById('downloadMenuPDF');

  if (downloadBtn) {
    downloadBtn.addEventListener('click', () => {
      const link = document.createElement('a');
      link.href = menuPdfUrl;
      link.download = 'viewer.3dtwins.tech/resultado_habitos (3).pdf';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });
  }

function subscribeEmail() {
  const email = document.getElementById('email').value;
  alert(`Gracias! Te enviaremos informaci√≥n a ${email}`);
}

window.addEventListener('DOMContentLoaded', async () => {
  initThree();
  await loadBaseModel();
  window.addEventListener('resize', () => {
    renderer.setSize(document.getElementById('threeCanvas').clientWidth, document.getElementById('threeCanvas').clientHeight);
    camera.aspect = document.getElementById('threeCanvas').clientWidth / document.getElementById('threeCanvas').clientHeight;
    camera.updateProjectionMatrix();
  });
});

// Abrir mini-modal
document.getElementById("openMiniLogin").addEventListener("click", () => {
  document.getElementById("miniLoginModal").style.display = "flex";
});

// Cerrar mini-modal
document.getElementById("closeMiniLogin").addEventListener("click", () => {
  document.getElementById("miniLoginModal").style.display = "none";
});

</script>


</body>
</html>


