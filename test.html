<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
 <link
      rel="icon"
         href="https://test.olibalife.site/logoolibalife.png"
      type="image/x-icon"
    />
<title>Test de h√°bitos Olibalife</title>
   <meta name="description" content="Test de h√°bitos gratis para mejorar tu salud y bienestar con Olibalife. Centro de estudios epigen√©ticos en Albacete.">
  <meta name="keywords" content="Olibalife, test de h√°bitos, mejorar mi salud, recetas saludables, estudio de h√°bitos online, estilo de vida saludable, an√°lisis epigen√©tico Albacete">
  <meta name="author" content="Olibalife">
  <meta name="robots" content="index, follow">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  background: #c7d3a550; 
  font-family: 'Intel', sans-serif;
  display: flex;
  min-height: 100svh;                
  
  overflow-x: hidden;               
  overflow-y: auto;   
  padding-bottom: 100px;               
}

.floating-header {
  position: fixed;
  top: 0px;
  left: 0;
  width: 100%;

  z-index: 9999;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px 14px;
  animation: fadeDown 0.6s ease-out;
}

.header-logo {
  height: 50px;
  width: auto;
  object-fit: contain;
  display: block;
 left: 20px;
margin: 10px;
}

@keyframes fadeDown {
  from { transform: translateY(-20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
.cta {
  background: #064445;
  color: #f5f5f5;
  font-weight: 800;
  font-size: 1rem;
  padding: 20px 8px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
  text-align: center;
  text-decoration: none;
  display: inline-block;
  margin: 10px 14px;
  scale: 1;
}

.cta:hover,
.cta:focus {
  transform: translateY(-2px) scale(1.05);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
  background: linear-gradient(135deg, #00ff77, #ffffff);
  outline: none;
  color: black;
}

.cta:active {
  transform: translateY(0px) scale(0.98);
  box-shadow: 0 5px 12px rgba(0, 0, 0, 0.2);
}
.dock-menu {
  display: flex;
  gap: 18px;
background: #064445;
  padding: 18px 20px;
  border-radius: 22px;
  backdrop-filter: blur(15px);
  box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
}

.dock-item {
  font-size: 1.1rem;
  color: white;
  text-decoration: none;
  transition: transform 0.25s ease, filter 0.25s ease, color 0.25s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.dock-item:hover {
  transform: scale(1.35);
  color: #0f9b4d;
  filter: drop-shadow(0 5px 8px rgba(0, 0, 0, 0.25));
}

.sidebar {
  width: 100%;
  backdrop-filter: blur(12px);
  display: flex;
  flex-direction: column;
  border-right: 1px solid rgba(255,255,255,0.2);
  height: 100%;
}

.main {
   color: #ffffff;
  width: 100%;
  margin-top: 35px;
  height: 800px;
  flex: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow: hidden;
  border-radius: 18px ;
  background: #dbe0e740;
  

}

.info {
  margin: 34px;
  width: 100%;
  max-width: 480px;                 
  height: 800px;
  min-width: 380;
  flex: 1;
  backdrop-filter: blur(12px);
    background: rgba(255, 255, 255, 0.95);
  padding: 20px;
  border-right: 1px solid rgba(0, 0, 0, 0.841);
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  overflow-y: auto;
  overflow-x: hidden;
  z-index: 9000;
  border-radius: 20px;
}

.results {
  margin: 0px;
  width: 40%;
  flex: 1;
  backdrop-filter: blur(12px);
  background: rgba(255, 0, 0, 0.804);
  padding: 40px;
  border-left: 1px solid rgba(255,255,255,0.2);
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  overflow-y: auto;
  overflow-x: hidden;
  border-radius: 20px;
}

.form-card {
  backdrop-filter: blur(20px);
 background:  #dbe0e7;
  padding: 55px;
  border-radius: 20px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.1);
  width: 100%;
  max-width: 300px;
  margin-bottom: 0px;
  color: black;
}

h2 {
  text-align: center;
  margin: 12px;
  color: rgb(0, 0, 0);
}

h3 {
  text-align: center;
  margin: 20px;
  color:  #ffffff;
}
p {
  text-align: center;
  margin: 10px;
  color:  #000000;
}

.avatar-img {
  width: 40px;
  height: auto;
  border-radius: 0px;
  display: block;
  position: fixed;
  bottom: 100px;
  right: 50px;
  z-index: 99999;
}

.quiz-form {
  display: flex;
  flex-direction: column;
  gap: 12px;                       
  width: 100%;
  max-width: 100%;                  
  color:#1f2937;
  font-size: clamp(14px, 3.5vw, 16px); 
}

 #quizProgress {
  height: 0px;
  width: 100%;
background: linear-gradient(135deg, #d8d8d8, #ffffff);
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 0px;
}

.question-card {
  width: 100%;
  backdrop-filter: blur(20px);
  background: #dbe0e762;
  border-radius: 16px;
  padding: 14px 16px;           
  box-shadow: 0 6px 20px rgba(255, 255, 255, 0.786);
}

.question-title {
  font-weight: 600;
  font-size: 1rem;
  margin-bottom: 8px;
  color: #0c2400;
}

.options {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.progress-circle {
  width: 60px;
 left: 10px;
  height: 60px;
  flex-shrink: 0;
  border-radius: 50%;
  background: conic-gradient(#49f360 0deg, #ddd 0deg);
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 20px;
  box-shadow: 0 0 15px rgba(159, 159, 159, 0.901);
  transition: background 1s ease-out;
}

.progress-circle span {
  font-weight: 600;
  font-size: 1.1rem;
  color: #000;
}

.category-cards-container {
  bottom: 0;                
  left: 50%;                 
  margin: 40px;
  width: 99%;               
  max-width: 480px;                 
  height: 800px;           
background: #064445;
  backdrop-filter: blur(15px);      
  border-radius: 20px;    
  padding: 10px;
  gap: 15px;             
  overflow-x: hidden;    
  z-index: 8500;         
  box-shadow: 0 -4px 12px rgba(0,0,0,0.15);
  flex: 3;
}

.category-card {
  flex: 0 0 auto;           
  width: auto;
  background: rgba(245, 245, 245, 0.043);
  color: #ffffff;
  border-radius: 20px;
  padding: 28px;
  display: flex;
  flex-direction: column;
  gap: 30px;
  box-shadow: 0 4px 12px rgba(54, 192, 223, 0.968);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  margin: 10px;
}

.category-bar {
  width: 100%;
  height: 6px;
  border-radius: 10px;
  background: rgba(67, 67, 67, 0.2);
  overflow: hidden;
}

.category-bar-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #ff0000, #00ff33);
  border-radius: 10px;
  transition: width 1s ease-out;
}


#threeCanvas-container {
  position: absolute;
  top: 44%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  height: 73%;
  display: flex;
  padding: 10px;
  justify-content: center;
  align-items: center;
}

#threeCanvas {
  max-width: 99%;
  height: 590px;
  border-radius: 8px;
background: transparent;

}


.results2 {
  position: fixed;     
  bottom: 0;          
  left: 0;            
  width: 100%;         
  max-width: 100%;
  height: 266px;       
  padding: 20px 60px;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  overflow-y: auto;    
  overflow-x: hidden;
    background: rgba(255, 255, 255, 0.95);
  color: #000000;
  z-index: 9999;  
}

 
.health-hud-container {
  width: 100%;             
  max-width: 90%;
  max-height: 200px;
  padding: 10px 20px;
background: #064445;
  backdrop-filter: blur(12px);
  border-radius: 8px;
  text-align: center;
  z-index: 9000;           
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.944);
  font-weight: 400;
  font-size: 1rem;
  color: #ffffff;
 margin: 30px;
}

.mini-modal {
  position: fixed;
  inset: 0; 
  background: rgb(255, 255, 255);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 999999;
  padding: 20px; 
}


.mini-modal-content {
  position: relative;
  background: #fff;
  border-radius: 18px; 
  width: 90%;         
  max-width: 900px;   
  height: 90%;         
  display: flex;
  flex-direction: column;
  padding: 20px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
  overflow: hidden; 
}

.mini-login-iframe {
  width: 100%;
  height: 100%; 
  border: none;
  border-radius: 12px;
}

.mini-modal-close {
  position: absolute;
  top: 15px;
  right: 15px;
  background: rgba(255,255,255,0.9);
  border: none;
  font-size: 1.6rem;
  cursor: pointer;
  padding: 4px 10px;
  border-radius: 6px;
  z-index: 10;
}

 
  footer {
    text-align: center; padding: 30px 20px;
 background: #ffffff;
     color: #000000; font-size: 0.9rem;
  }
  footer a { color:  rgb(7, 0, 133); 
    margin: 0 8px; }


@media (max-width: 900px) {
  body,
  .main {
    padding-bottom: 230px;
  }

  .results {
    display: none;
  }

  .info {
    max-width: 90%;
  }

  #threeCanvas-container,
  #threeCanvas {
    height: 400px;
  }

  .results2 {
    height: 220px;
    padding: 15px 20px;
  }
}


@media (max-width: 748px) {


  body {
    flex-direction: column;
    padding-bottom: 220px; 
  }

  .floating-header {
    top: 8px;
    padding: 10px;
  }

  .dock-menu {
    gap: 14px;
    padding: 14px 18px;
    border-radius: 20px;
  }

  .dock-item {
    font-size: 1.1rem;
  }


  .main {
    margin-top: 70px;
    height: auto;
    overflow: visible;
    border-radius: 16px;
  }


  .info {
    margin: 30px auto;
    width: 90%;
    max-width: 520px;
    max-height: none;
    overflow: visible;
    padding: 18px;
    border-radius: 20px;
  }

  .quiz-form {
    font-size: 1rem;
    gap: 12px;
  }

  
  #threeCanvas-container {
    position: relative;
    top: auto;
    left: auto;
    transform: none;
    margin: 30px auto;
    height: auto;
  }

  #threeCanvas {
    height: 340px;
    max-width: 95%;
    border-radius: 24px;
  }

  
  .category-cards-container {
    position: relative;
    margin: 30px auto;
    width: 90%;
    max-width: 520px;
    height: auto;
    padding: 18px;
    overflow: visible;
  }

  .category-card {
    width: 100%;
    margin-bottom: 16px;
    padding: 26px;
  }

 
  .results2 {
    height: 190px;
    padding: 16px 22px;
    font-size: 0.9rem;
  }


  .health-hud-container {
    font-size: 1rem;
    padding: 10px 16px;
    border-radius: 18px;
  }

 
  .avatar-img {
    width: 10px;
    bottom: 14px;
    right: 14px;
  }


  .results {
    display: none;
  }

 
  .mini-modal-content {
    width: 92%;
    height: 92%;
    padding: 16px;
    border-radius: 16px;
  }
}


@media (max-width: 600px) {


  body {
    flex-direction: column;
    padding-bottom: 190px;
    overflow-y: auto;
  }

  
  .floating-header {
    top: 6px;
    padding: 8px;
  }

  .dock-menu {
    gap: 12px;
    padding: 12px 14px;
    border-radius: 18px;
  }

  .dock-item {
    font-size: 1rem;
  }

    .cta {
    width: 100%;        
    font-size: 0.95rem;
    padding: 12px 20px;
    margin: 6px 0;
  }

  .main {
    margin-top: 90px; 
    height: auto;
    border-radius: 0;
    overflow: visible;
    padding-bottom: 10px;
  }


  .info {
    margin: 20px auto;
    width: 92%;
    max-width: 100%;
    max-height: none;
    overflow: visible;
    padding: 14px;
    border-radius: 18px;
  }

  .quiz-form {
    font-size: 0.95rem;
    gap: 10px;
  }

  .question-card {
    padding: 14px;
  }

  
  .progress-circle {
    width: 80px;
    height: 80px;
  }


  #threeCanvas-container {
    position: relative;
    top: 40px;
    left: auto;
    transform: none;
    height: auto;
    margin: 10px 10px;
  }

  #threeCanvas {
    height: 400px;
    max-width: 100%;
    border-radius: 20px;
    margin: 0px 10px;
  }



  .category-cards-container {
     top: auto;
    left: auto;
    margin: 10px;
    width: 100%;
    max-width: 95%;
    height: 800px;
    padding: 8px;
    overflow: visible;
  }

  .category-card {
    width: 100%;
    margin: 0 0 4px 0;
    padding: 20px;
  }


  .results2 {
    height: 175px;
    padding: 28px 60px;
    font-size: 0.85rem;
    backdrop-filter: blur(18px);
  }


  .health-hud-container {
    font-size: 0.95rem;
    padding: 8px 12px;
    border-radius: 16px;
  }


  .avatar-img {
    width: 60px;
    bottom: 99px;
    right: 50px;
  }


  .results {
    display: none;
  }


  .mini-modal-content {
    width: 95%;
    height: 95%;
    padding: 12px;
    border-radius: 14px;
    z-index: 99999;
  }

  .mini-login-iframe {
    min-height: 0;
     z-index: 99999;
  }
    .cta {
    width: 100%;
    font-size: 0.95rem;
    padding: 12px 20px;
  }  
  
  .mini-modal-close {
  position: absolute;
  top: 15px;
  right: 15px;
  background: rgba(255,255,255,0.9);
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
  padding: 4px 10px;
  border-radius: 6px;
  z-index: 9999999;
}

    #resultsHUD {
    position: relative;     
    top: 0px;    
    left: auto;
    transform: none;   
    width: 90%;             
    max-width: 5%;         
    height: auto;          
    max-height: none;     
    padding: 2px;           
    border-radius: 16px;     
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    pointer-events: none;
    scale: 1;
    background-image: url('https://test.olibalife.site/bannercambiar.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-blend-mode: overlay;
    background-color: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(40px); 
  }
}

@media (max-width: 480px) {

  body {
    flex-direction: column;
    padding-bottom: 190px; 
    overflow-y: auto;
  }

  .floating-header {
    top: 0px;
    padding: 8px;
  }

  .dock-menu {
    gap: 12px;
    padding: 12px 14px;
    border-radius: 8px;
  }

  .dock-item {
    font-size: 1rem;
  }


  .main {
    margin-top: 0px; 
    height: auto;
    border-radius: 0;
    overflow: visible;
    padding-bottom: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

 
  .info {
   
    margin: 3px auto;
    width: 92%;
    max-width: 100%;
    max-height: none;
    overflow: visible;
    padding: 14px;
    border-radius: 8px;
  }

  .quiz-form {
    font-size: 0.95rem;
    gap: 10px;
  }

  .question-card {
    padding: 14px;
  }

 
  .progress-circle {
    width: 80px;
    height: 80px;
  }


  #threeCanvas-container {
 
    position: relative;
    top: 25px;
    left: auto;
    transform: none;
    height: auto;
    margin: 10px 0;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 99%;
       scale: 0.99;
  }

  #threeCanvas {
    height: 390px;
    max-width: 99%;
    border-radius: 8px;
     scale: 1;
  }


  .category-cards-container {
    position: relative;
    margin: 16px auto; 
    max-width: 100%;
    height: auto;
    padding: 14px;
    overflow: visible;
  }

  .category-card {
    width: 100%;
    margin: 0 0 12px 0; 
    padding: 22px;
  }

  .results2 {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    max-width: 100%;
    height: 140px;
    padding: 12px 16px;
    font-size: 0.85rem;
    backdrop-filter: blur(8px);
    overflow-y: auto;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    z-index: 99999;
  }

  .health-hud-container {
    font-size: 0.95rem;
    padding: 12px 12px;
    border-radius: 16px;
    width: 95%;
    margin: 12px;
  }

  .avatar-img {
    width: 30px;
    bottom: 100px;
    right: 38px;
  }

  .results {
    display: none;
  }

 
  .mini-modal-content {
    width: 95%;
    height: 95%;
    padding: 12px;
    border-radius: 14px;
  }

  .mini-login-iframe {
    min-height: 0;
  }


  .cta {
    width: 100%;
    font-size: 0.95rem;
    padding: 12px 20px;
  }
  #hudContainer {
   position: relative; 
     width: 99%; 
     height: 400px; 
     margin: 0px; 
     z-index: 9900;
  }
   
       #resultsHUD {
    position: relative;     
    top: 0px;              
    left: auto;
    transform: none;         
    width: 90%;              
    max-width: 100%;   
    height: 90%;            
    max-height: none;       
    padding: 2px;         
    border-radius: 16px;    
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    pointer-events: none;
    scale: 1;
    background-image: url('https://test.olibalife.site/bannercambiar.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-blend-mode: overlay;
    background-color: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(40px); 
  }
}


</style>
</head>
<body>

<header class="main-header">
  <img 
    class="header-logo"
    src="https://test.olibalife.site/logoolibalife.png"
    alt="OlibaLife">
</header>


<div class="info"><nav class="dock-menu">
  
    <a href="https://test.olibalife.site/" class="dock-item"> <i class="fa-solid fa-dna"></i> </a>
    <a href="https://test.olibalife.site/login.html" class="dock-item"><i class="fa-solid fa-user"></i></a>
  </nav>
 
  <h2>Test de h√°bitos saludables</h2>

  <form id="quizForm" class="quiz-form">
    

    <div class="question-card">
      <div class="question-title">1. Nivel de energ√≠a diario</div>
      <div class="options">
        <label class="option"><input type="radio" name="q1" value="20"> Alta</label>
        <label class="option"><input type="radio" name="q1" value="15"> Moderada</label>
        <label class="option"><input type="radio" name="q1" value="10"> Baja</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">2. Horas de sue√±o promedio</div>
      <div class="options">
        <label class="option"><input type="radio" name="q2" value="20"> 7-8 h</label>
        <label class="option"><input type="radio" name="q2" value="15"> 5-6 h</label>
        <label class="option"><input type="radio" name="q2" value="10"> Menos de 5 h</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">3. Frecuencia de ejercicio</div>
      <div class="options">
        <label class="option"><input type="radio" name="q3" value="20"> Diario</label>
        <label class="option"><input type="radio" name="q3" value="15"> 2-3 veces/semana</label>
        <label class="option"><input type="radio" name="q3" value="10"> Rara vez</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">4. Consumo de frutas y verduras</div>
      <div class="options">
        <label class="option"><input type="radio" name="q4" value="20"> Diario</label>
        <label class="option"><input type="radio" name="q4" value="15"> 3-4 veces/semana</label>
        <label class="option"><input type="radio" name="q4" value="10"> Menos de 3 veces/semana</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">5. Hidrataci√≥n diaria</div>
      <div class="options">
        <label class="option"><input type="radio" name="q5" value="20"> 2 litros o m√°s</label>
        <label class="option"><input type="radio" name="q5" value="15"> 1-2 litros</label>
        <label class="option"><input type="radio" name="q5" value="10"> Menos de 1 litro</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">6. Nivel de estr√©s</div>
      <div class="options">
        <label class="option"><input type="radio" name="q6" value="10"> Bajo</label>
        <label class="option"><input type="radio" name="q6" value="15"> Moderado</label>
        <label class="option"><input type="radio" name="q6" value="20"> Alto</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">7. Tiempo frente a pantallas</div>
      <div class="options">
        <label class="option"><input type="radio" name="q7" value="20"> Menos de 2 h</label>
        <label class="option"><input type="radio" name="q7" value="15"> 2-5 h</label>
        <label class="option"><input type="radio" name="q7" value="10"> M√°s de 5 h</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">8. Consumo de az√∫car</div>
      <div class="options">
        <label class="option"><input type="radio" name="q8" value="20"> Bajo</label>
        <label class="option"><input type="radio" name="q8" value="15"> Moderado</label>
        <label class="option"><input type="radio" name="q8" value="10"> Alto</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">9. Consumo de alcohol</div>
      <div class="options">
        <label class="option"><input type="radio" name="q9" value="20"> Ninguno</label>
        <label class="option"><input type="radio" name="q9" value="15"> Ocasional</label>
        <label class="option"><input type="radio" name="q9" value="10"> Frecuente</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">10. Calidad de relaciones sociales</div>
      <div class="options">
        <label class="option"><input type="radio" name="q10" value="20"> Muy buena</label>
        <label class="option"><input type="radio" name="q10" value="15"> Regular</label>
        <label class="option"><input type="radio" name="q10" value="10"> Mala</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">11. Nivel de atenci√≥n y concentraci√≥n</div>
      <div class="options">
        <label class="option"><input type="radio" name="q11" value="20"> Alta</label>
        <label class="option"><input type="radio" name="q11" value="15"> Moderada</label>
        <label class="option"><input type="radio" name="q11" value="10"> Baja</label>
      </div>
    </div>

    <div class="question-card">
      <div class="question-title">12. Estado de √°nimo general</div>
      <div class="options">
        <label class="option"><input type="radio" name="q12" value="20"> Muy bueno</label>
        <label class="option"><input type="radio" name="q12" value="15"> Regular</label>
        <label class="option"><input class="option" type="radio" name="q12" value="10"> Bajo</label>
      </div>
    </div>

    <button type="button" class="cta" onclick="updateScore()">Ver Resultado</button>
    <button type="button" class="cta" onclick="downloadPatientFile()">Descargar mi ficha</button>
  </form>
  
</div>

<div class="main">

       <div class="progress-circle" id="progressCircleHUD">
   <span>0%</span>
   </div> 

     <div class="health-hud-container">
  <div id="healthMessageHUD"></div>
</div>
     
  <div id="hudContainer" style="position: relative; width: 99%; height: 600px; margin: 0px; z-index: 9900; ">  

    <div id="resultsHUD" style="
      position: absolute;
      padding: 10px;
      margin: 0px;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 95%;
      height: 100%;
      max-width: 480px;
      max-height: 580px;
      border-radius: 20px;
      display: flex;
   flex: 2;
      align-items: center;
      gap: 0px;
      pointer-events: none;
      scale:1;
      background-image: url('https://test.olibalife.site/fondo3.png');
      background-size: cover;    
      background-position: center;
      background-repeat: no-repeat;
      background-blend-mode: overlay;
      background-color: rgba(203, 203, 203, 0);
      backdrop-filter: blur(0px);
     
      
    ">      
 <div id="threeCanvas-container">
  <canvas id="threeCanvas"></canvas>
</div>      
   </div>      
      </div>     
          </div>
    
<div class="category-cards-container"> 
    <h3>Prueba a mejorar tus h√°bitos con estos peque√±os cambios</h3>   
     
  <div class="category-cards" id="categoriesContainerHUD"></div>
</div>

  <div id="miniLoginModal" class="mini-modal">
    <div class="mini-modal-content">
      <button class="mini-modal-close" id="closeMiniLogin">‚úï</button>
      <iframe 
        src="https://test.olibalife.site/login.html" 
        class="mini-login-iframe" 
        frameborder="0" 
        loading="lazy">
      </iframe>
    </div>
  </div>
<div class="results2">
 <button id="openMiniLogin" class="cta">Reg√≠strate y obt√©n una gu√≠a de alimentaci√≥n drenante gratis.</button>
   <h2>¬øSientes que necesitas un estudio avanzado?</h2>
   Con una simple muestra capilar analizamos c√≥mo est√°n funcionando tus c√©lulas y qu√© factores pueden estar afectando a tu energ√≠a, tu metabolismo y tu bienestar.
  </p>
  <p>
    <strong>¬øQu√© analiza?</strong> Carencias de vitaminas, minerales y antioxidantes
Estr√©s celular, inflamaci√≥n y envejecimiento interno
Sensibilidades alimentarias
Estado de tu microbiota y digesti√≥n
T√≥xinas ambientales: metales pesados, qu√≠micos y radiaciones
Interferencias EMF/ELF: wifi, m√≥viles y aparatos electr√≥nicos
C√≥mo esto implica en tu energ√≠a, metabolismo, descanso y hormonas

    <strong>Muestra:</strong> Cabello (estudio no invasivo)
    <strong>Tiempo de resultados:</strong> M√°ximo 7 d√≠as
    <strong>¬øPara qu√© sirve?:</strong> Para recibir un informe personalizado y saber qu√© h√°bitos, nutrientes o cambios necesitas aplicar para mejorar tu salud desde el origen.
  </p>
<footer>
  ¬© 2026 www.olibalife.com - Todos los derechos reservados - desarrollado por www.3dtwins.es 
  <br>
  <a href="https://olibalife.com/politica-de-privacidad/">Pol√≠tica de privacidad</a> | 
  <a href="https://olibalife.com/compromiso-con-la-proteccion-de-datos-personales/">Protecci√≥n de datos</a> | 
    <a href="https://olibalife.com/accesibilidad/">Accesibilidad</a> | 
       <a href="https://olibalife.com/aviso-legal/">Aviso legal</a> | 
  <a href="https://olibalife.com/compromiso-con-la-proteccion-de-datos-personales/">Pol√≠tica de cookies</a> 
</footer>
</div>


<script src="https://cdn.jsdelivr.net/npm/three@0.134.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/exporters/GLTFExporter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-W9G2DWC51B"></script>


<script>
window.dataLayer = window.dataLayer || [];
  function gtag(){ dataLayer.push(arguments); }

  gtag('js', new Date());

  const GA_DEFAULT = 'G-W9G2DWC51B';
  if (GA_DEFAULT) {
    gtag('config', GA_DEFAULT, { anonymize_ip: true });
  }

  const sessionId = sessionStorage.getItem('vhSessionId') || crypto.randomUUID();
  sessionStorage.setItem('vhSessionId', sessionId);

  // ===== Funci√≥n gen√©rica de tracking =====
  window.trackEvent = function(eventName, payload = {}) {
    if (!eventName) return;

    const eventData = {
      session_id: sessionId,
      timestamp: Date.now(),
      ...payload
    };

    console.log('[TRACK]', eventName, eventData);

    if (typeof gtag === 'function') {
      gtag('event', eventName, eventData);
    }
  };

  
  document.querySelectorAll('.dock-item').forEach((item, index) => {
    item.addEventListener('click', () => {
      trackEvent('test_dock_click', {
        origin: 'habits_test',
        position: index === 0 ? 'home' : 'login'
      });
    });
  });

  document.getElementById('openMiniLogin')?.addEventListener('click', () => {
    trackEvent('test_register_click', {
      origin: 'habits_test',
      percent: getHUDScore(),
      placement: 'post_results'
    });
  });


  document.querySelector('button.cta[onclick*="updateScore"]')?.addEventListener('click', () => {
    trackEvent('test_result_view', {
      origin: 'habits_test',
      percent: getHUDScore(),
      answered: (() => {
        const form = document.getElementById('quizForm');
        return form ? new FormData(form).size : 0;
      })()
    });
  });


  document.querySelector('button.cta[onclick*="downloadPatientFile"]')?.addEventListener('click', () => {
    trackEvent('test_pdf_download', {
      origin: 'habits_test',
      percent: getHUDScore(),
      has_results: getHUDScore() > 0
    });
  });



let baseModelURL = 'https://viewer.3dtwins.tech/adnOlivalife.glb';
let gltfScene = null;
let renderer, scene, camera;

let latestScore = 0;
let latestCategories = [];
let latestTips = {}; 

function initThree() {
  const canvas = document.getElementById('threeCanvas');
  const container = document.getElementById('threeCanvas-container');

  scene = new THREE.Scene();
  camera = new THREE.PerspectiveCamera(65, container.clientWidth / container.clientHeight, 0.01, 1000);
  camera.position.set(0, 0, 5.4);
  renderer = new THREE.WebGLRenderer({ alpha: true, canvas: canvas, antialias: true });
  renderer.setPixelRatio(window.devicePixelRatio); // para pantallas retina
  renderer.setSize(container.clientWidth, container.clientHeight);
  const light = new THREE.DirectionalLight(0xffffff, 1.2);
  light.position.set(1, 6, 5);
  scene.add(light);
  scene.add(new THREE.AmbientLight(0xffffff, 0.6));
  window.addEventListener('resize', () => {
    const width = container.clientWidth;
    const height = container.clientHeight; 
    camera.aspect = width / height;
    camera.updateProjectionMatrix();
  });
}

async function loadBaseModel() {
  return new Promise((resolve, reject) => {
    const loader = new THREE.GLTFLoader();
    loader.load(
      baseModelURL,
      (gltf) => {
        gltfScene = gltf.scene;
        gltfScene.scale.set(9.8, 6.66, 6.6);
        gltfScene.position.set(0, -3.5, -1.9);
        scene.add(gltfScene);
        animate();    
        trackEvent('model_loaded', { model_url: baseModelURL });
        resolve(gltfScene);
      },
      undefined,
      (err) => {
        trackEvent('model_load_error', { model_url: baseModelURL, error: err.message || err });
        reject(err);
      }
    );
  });
}


function animate() {
  requestAnimationFrame(animate);
  if(gltfScene) gltfScene.rotation.y += 0.001; 
  renderer.render(scene, camera);
}

function getTips(category, score) {
  const tipsDB = {
    'Nutrici√≥n': [
      ["Aumenta frutas y verduras diarias.", "Bebe al menos 2 litros de agua.", "Reduce az√∫cares refinados."],
      ["Incluye prote√≠nas magras en cada comida.", "Var√≠a tu dieta semanalmente.", "Controla el tama√±o de las porciones."],
      ["Mant√©n un registro de tu alimentaci√≥n.", "Experimenta con superalimentos.", "Optimiza tus horarios de comida."]
    ],
    'Ejercicio': [
      ["Camina 30 min diarios.", "Evita periodos prolongados sentado.", "Prueba ejercicios de fuerza simples."],
      ["A√±ade 2‚Äì3 sesiones de cardio por semana.", "Incorpora entrenamiento de fuerza.", "Incluye estiramientos al final de cada sesi√≥n."],
      ["Var√≠a tus rutinas semanalmente.", "Prueba entrenamientos de alta intensidad.", "Mide tus progresos con apps o dispositivos."]
    ],
    'Sue√±o': [
      ["Intenta dormir 7‚Äì8 horas.", "Evita pantallas 1h antes de dormir.", "Mant√©n horarios regulares."],
      ["Crea una rutina de relajaci√≥n nocturna.", "Controla la temperatura de tu habitaci√≥n.", "Evita cafe√≠na por la tarde."],
      ["Usa t√©cnicas de respiraci√≥n profunda.", "Eval√∫a tu colch√≥n y almohadas.", "Mant√©n un diario de sue√±o para mejorar h√°bitos."]
    ],
    'Estr√©s': [
      ["Respira profundamente varias veces al d√≠a.", "Toma peque√±os descansos durante el trabajo.", "Haz algo que disfrutes cada d√≠a."],
      ["Practica meditaci√≥n o mindfulness.", "Realiza actividad f√≠sica regular.", "Establece l√≠mites claros entre trabajo y vida personal."],
      ["Realiza ejercicios de visualizaci√≥n positiva.", "Aprende t√©cnicas de manejo del tiempo.", "Busca apoyo social o profesional cuando lo necesites."]
    ]
  };

  if(score < 40) return tipsDB[category][0];
  else if(score < 70) return tipsDB[category][1];
  else return tipsDB[category][2];
}

function updateScore() {
  const form = document.getElementById('quizForm');
  const formData = new FormData(form);
  let totalScore = 0;
  let answered = 0;

  const categories = [
    { name: 'Nutrici√≥n', questions: ['q4', 'q5'], score: 0, max: 20*2 },
    { name: 'Ejercicio', questions: ['q3'], score: 0, max: 20 },
    { name: 'Sue√±o', questions: ['q2', 'q1'], score: 0, max: 20*2 },
    { name: 'Estr√©s', questions: ['q6', 'q7', 'q8', 'q9', 'q10', 'q11', 'q12'], score: 0, max: 20*7 }
  ];

  formData.forEach((value, key) => {
    const val = parseInt(value);
    totalScore += val;
    answered++;

    categories.forEach(cat => {
      if (cat.questions.includes(key)) cat.score += val;
    });
  });

  if (answered === 0) return alert("Por favor, responde al menos una pregunta.");

  latestScore = totalScore;
  latestCategories = categories.map(cat => ({ name: cat.name, score: Math.round(cat.score / cat.max * 100) }));

 const maxScore = 240;
const percent = Math.round((totalScore / maxScore) * 100);

  const progressCircle = document.getElementById('progressCircleHUD');
  const angle = percent * 3.6;
  progressCircle.style.background = `conic-gradient(#00d37b 0deg, #00d37g ${angle}deg, #ddd ${angle}deg)`;
  progressCircle.querySelector('span').innerText = percent + '%';

  let message = "";
  if (percent < 40) message = "‚ö†Ô∏è Tus h√°bitos de salud necesitan mejorar. Te recomendamos tomar acci√≥n ¬°YA!.";
  else if (percent < 70) message = "üü† Est√°s en un punto intermedio, puedes mejorar algunos h√°bitos. ";
  else message = "üü¢ Excelente, tus h√°bitos son muy saludables.";
  document.getElementById('healthMessageHUD').textContent = message;

  latestTips = {};
  const container = document.getElementById('categoriesContainerHUD');
  container.innerHTML = '';

  latestCategories.forEach(cat => {
    const tips = getTips(cat.name, cat.score);
    latestTips[cat.name] = tips;

    const card = document.createElement('div');
    card.className = 'category-card show';
    card.innerHTML = `<div class="category-name">${cat.name}</div>
                      <div class="category-bar"><div class="category-bar-fill" style="width:${cat.score}%"></div></div>
                      <ul class="category-tips">
                        ${tips.map(t => `<li>${t}</li>`).join('')}
                      </ul>`;
    container.appendChild(card);
  });

  if (gltfScene) {
    gltfScene.traverse(child => {
      if (child.isMesh) {
        let color;
        if (percent < 40) color = new THREE.Color(0x000000);
        else if (percent < 70) color = new THREE.Color(0xFF6105);
        else color = new THREE.Color(0x00F004);
        child.material.color = color;
        child.material.needsUpdate = true;
      }
    });

    gltfScene.userData = { totalScore, categories: latestCategories, percent, tips: latestTips };
  }

  trackEvent('quiz_submitted', {
    totalScore: latestScore,
    categories: latestCategories.map(cat => ({ name: cat.name, score: cat.score })),
    percent: percent
  });
}


async function downloadGLB() {
  if (!gltfScene) await loadBaseModel();
  const exporter = new THREE.GLTFExporter();
  exporter.parse(gltfScene, (result) => {
    const blob = result instanceof ArrayBuffer 
      ? new Blob([result], {type:'application/octet-stream'}) 
      : new Blob([JSON.stringify(result, null, 2)], {type:'application/json'});
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'resultado_habitos.glb';
    link.click();
  }, { binary: true });
}


function getHUDScore() {
  const progressCircle = document.getElementById('progressCircleHUD');
  if (!progressCircle) return 0;

  const span = progressCircle.querySelector('span');
  if (!span) return 0;

  const text = span.textContent || '0%';
  const percent = parseInt(text.replace('%',''), 10);
  return isNaN(percent) ? 0 : percent;
}


async function downloadPDF() {
  const hudPercent = getHUDScore();

  trackEvent('download_pdf_clicked', { hudPercent });

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({
    orientation: "portrait",
    unit: "pt",
    format: "a4"
  });

  const pdfWidth = 595;   
  const pdfHeight = 842;  
  const margin = 40;
  let y = 100;

  renderer.render(scene, camera);
  await new Promise(resolve => requestAnimationFrame(resolve));

  const canvas = renderer.domElement;
  const tmpCanvas = document.createElement("canvas");
  tmpCanvas.width = canvas.width;
  tmpCanvas.height = canvas.height;
  const tmpCtx = tmpCanvas.getContext("2d");
  tmpCtx.globalAlpha = 0.3; 
  tmpCtx.drawImage(canvas, 0, 0);
  const canvasDataURL = tmpCanvas.toDataURL("image/png");
  const imgHeight = pdfHeight * 0.9;
  const imgY = (pdfHeight - imgHeight) / 2;
  doc.addImage(canvasDataURL, 'PNG', 0, imgY, pdfWidth, imgHeight, undefined, 'FAST');

  doc.setFillColor(210, 222, 175);
  doc.rect(0, 0, pdfWidth, 80, 'F');
  doc.setFontSize(22);
  doc.setFont("helvetica", "bold");
  doc.setTextColor(0, 0, 0);
  doc.text("Resultados de tu test de h√°bitos Olibalife", pdfWidth / 2, 50, { align: "center" });


  y += 10; 
  doc.setFontSize(14);
  doc.setFont("helvetica", "bold");
  doc.setTextColor(0, 70, 0);
  doc.text(`Porcentaje de autocuidado: ${hudPercent}%`, margin, y);
  y += 35; 

  const contentWidth = pdfWidth - 2 * margin;

  latestCategories.forEach(cat => {
    doc.setFillColor(200, 230, 201);
    doc.roundedRect(margin - 4, y - 14, contentWidth, 24, 6, 6, 'F');

    doc.setFontSize(13);
    doc.setFont("helvetica", "bold");
    doc.setTextColor(0, 70, 0);
    doc.text(`${cat.name}: ${cat.score}%`, margin, y);
    y += 28;

    const tips = latestTips[cat.name] || [];
    doc.setFontSize(11);
    doc.setFont("helvetica", "normal");
    doc.setTextColor(50, 50, 50);

    tips.forEach(tip => {
      const tipLines = doc.splitTextToSize(tip, contentWidth - 10); // sangr√≠a 10
      tipLines.forEach(tl => {
        if (y > 700) {
          doc.addPage();
          y = 60;
        }
        doc.text(`‚Ä¢ ${tl}`, margin + 10, y);
        y += 14;
      });
    });

    y += 10;
    doc.setDrawColor(200, 200, 200);
    doc.setLineWidth(0.5);
    doc.line(margin, y, pdfWidth - margin, y);
    y += 15;
  });


const ctaText = "Te recomendamos ver nuestros test epigen√©ticos avanzados:";
const ctaLink = "https://test.olibalife.site";
const paddingX = 12; // horizontal
const paddingY = 20; // vertical
const ctaLines = doc.splitTextToSize(ctaText, contentWidth - 2 * paddingX);
const ctaBlockHeight = paddingY * 2 + ctaLines.length * 14 + 14; // +14 para el link

if (y + ctaBlockHeight > 700) {
  doc.addPage();
  y = 60;
}


doc.setFillColor(255, 235, 205);
doc.roundedRect(margin - 4, y - 4, contentWidth, ctaBlockHeight, 6, 6, 'F');


doc.setFontSize(12);
doc.setFont("helvetica", "bold");
doc.setTextColor(80, 0, 80); 
let textY = y + paddingY;
ctaLines.forEach(line => {
  doc.text(line, margin + paddingX, textY);
  textY += 14;
});


doc.setTextColor(0, 0, 255);
doc.setFont("helvetica", "normal");
doc.textWithLink("Hacer el test aqu√≠", margin + paddingX, textY, { url: ctaLink });

y += ctaBlockHeight + 10; 


  const footerText = "www.olibalife.com | Todos los derechos reservados | Registrate gratis y obt√©n tu gu√≠a";
  const footerLines = doc.splitTextToSize(footerText, pdfWidth - 2 * margin);
  let footerY = 780 - (footerLines.length - 1) * 14;
  doc.setFontSize(11);
  doc.setFont("helvetica", "bold");
  doc.setTextColor(0, 100, 0);
  footerLines.forEach(line => {
    doc.text(line, pdfWidth / 2, footerY, { align: "center" });
    footerY += 14;
  });

  doc.save('resultados_test_habitos_Olibalife.pdf');
}



function downloadPatientFile() {
  trackEvent('download_patient_file_clicked', { totalScore: latestScore });
  //downloadGLB();
  downloadPDF();
}

  const menuPdfUrl = '';

  const downloadBtn = document.getElementById('downloadMenuPDF');

  if (downloadBtn) {
    downloadBtn.addEventListener('click', () => {
      const link = document.createElement('a');
      link.href = menuPdfUrl;
      link.download = 'viewer.3dtwins.tech/resultado_habitos (3).pdf';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });
  }

window.addEventListener('DOMContentLoaded', async () => {
  initThree();
  await loadBaseModel();
  window.addEventListener('resize', () => {
    renderer.setSize(document.getElementById('threeCanvas').clientWidth, document.getElementById('threeCanvas').clientHeight);
    camera.aspect = document.getElementById('threeCanvas').clientWidth / document.getElementById('threeCanvas').clientHeight;
    camera.updateProjectionMatrix();
  });
});

document.getElementById("openMiniLogin").addEventListener("click", () => {
  document.getElementById("miniLoginModal").style.display = "flex";
});

document.getElementById("closeMiniLogin").addEventListener("click", () => {
  document.getElementById("miniLoginModal").style.display = "none";
});

</script>


</body>
</html>

